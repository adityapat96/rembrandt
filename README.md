# Rembrandt Project: Morphological Feature Extraction and Machine Learning for Tumor Volume and Surface Area Prediction

This repository contains code for extracting morphological features from MRI and segmentation data of brain tumors and using these features for machine learning-based prediction of tumor volume and surface area.  The analysis is based on data described in this [publication](https://www.nature.com/articles/s41597-022-01415-1).

This project is comprised of two main Jupyter Notebooks: `prelim_morphological.ipynb` and `ml_volume.ipynb`.  These notebooks are described below, but can be run sequentially to perform the complete analysis.

## 1. Preliminary Morphological Feature Extraction (`prelim_morphological.ipynb`)

This notebook performs the following steps:

1. **Data Loading:** Loads MRI (`t1_LPS_rSRI.nii.gz` or `.nii`) and segmentation (`GlistrBoost_out.nii.gz`) data for multiple patients from a specified directory (currently set to `C:\Users\adity\Documents\Python projects\Rembrandt\Rembrandt_data\Rembrandt_Final_Data`). The code handles potential errors during file loading.

2. **Feature Extraction:** For each patient, it extracts the following features from the tumor region (defined by the segmentation mask):
    * **Volume:** Total volume of the tumor.
    * **Mean Intensity:** Average intensity of MRI signal within the tumor.
    * **Standard Deviation of Intensity:** Standard deviation of MRI signal within the tumor.
    * **Skewness:** Skewness of the MRI intensity distribution within the tumor.
    * **Kurtosis:** Kurtosis of the MRI intensity distribution within the tumor.
    * **Surface Area:** Surface area of the tumor (calculated using marching cubes).
    * **Bounding Box Dimensions:** Dimensions (x, y, z) of the smallest bounding box enclosing the tumor.

3. **Data Output:** The extracted features are saved as a CSV file named `morphological.csv`.

**Dependencies:** nibabel, numpy, os, pandas, scipy, scikit-image, tqdm


## 2. Machine Learning for Volume and Surface Area Prediction (`ml_volume.ipynb`)

This notebook utilizes the `morphological.csv` file generated by `prelim_morphological.ipynb` to perform machine learning.  The steps are:

1. **Data Loading:** Loads the morphological features from `morphological.csv`.

2. **Data Preprocessing:**
    * Separates features (mean intensity, standard deviation, skewness, kurtosis, bounding box dimensions) from target variables (tumor volume and surface area).
    * Splits the data into training and testing sets (80% train, 20% test) using a random state of 42 for reproducibility.
    * Standardizes the numerical features using `StandardScaler`.

3. **Model Training and Evaluation:**
    * Trains a `RandomForestRegressor` to predict both tumor volume and surface area.
    * Evaluates model performance using Mean Squared Error (MSE) and R-squared (RÂ²) scores.  A grid search is performed to optimize hyperparameters for volume prediction.

**Dependencies:** pandas, scikit-learn, numpy


This project demonstrates a workflow for extracting relevant morphological features from medical image data and applying machine learning techniques for predictive modeling.  Future work could involve exploring more sophisticated feature extraction methods, different machine learning models, and a more rigorous evaluation process.
